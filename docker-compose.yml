version: "3.7"

services:

  fastapi-app:

    build:

      context: ./fastapi-app

      dockerfile: Dockerfile

    container_name: FastApi-app

    ports:

      - "5001:5001"



  sonarqube:

    image: sonarqube:latest

    container_name: sonarqube

    ports:

      - "9000:9000"

    environment:

      - SONAR_ES_BOOTSTRAP_CHECKS_DISABLE=true

    volumes:

      - sonarqube_conf:/opt/sonarqube/conf

      - sonarqube_data:/opt/sonarqube/data

      - sonarqube_logs:/opt/sonarqube/logs

      - sonarqube_extensions:/opt/sonarqube/extensions



  prometheus:

    image: prom/prometheus:latest

    container_name: prometheus

    volumes:

      - ./prometheus/prometheus.yml:/etc/prometheus/prometheus.yml

    ports:

      - "7070:9090"

    command:

      - "--config.file=/etc/prometheus/prometheus.yml"



  grafana:

    image: grafana/grafana:latest

    container_name: grafana

    ports:

      - "3000:3000"

    environment:

      - GF_SECURITY_ADMIN_PASSWORD=admin

    volumes:

      - grafana-data:/var/lib/grafana



  node-exporter:

    image: prom/node-exporter:latest

    container_name: node-exporter

    ports:

      - "7100:9100"



volumes:

  sonarqube_conf:

  sonarqube_data:

  sonarqube_logs:

  sonarqube_extensions:

  grafana-data:
